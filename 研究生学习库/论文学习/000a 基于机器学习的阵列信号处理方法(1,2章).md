# 基本信息：

[[2019_吴_基于机器学习的阵列信号处理方法.pdf]]

来源：国防科技大学博士毕业论文

作者：吴流丽

导师：黄知涛

年份：2019

# 摘要：

本文重点研究机器学习技术在宽频段/宽带信号测向、超分辨测向、模型失配条件下测向以及小训练样本条件下测向等方面的应用

1.  针对实际阵列测向系统中面临的可变载频信号测向需求以及宽带信号测向需求，提出基于支持向量回归（SVR）的可变载频信号测向方法VFSVR，以及基于SVR的宽带信号测向方法CWSVR（Coherent Wideband SVR）
2.  为了满足复杂环境中阵列测向系统对测向精度以及分辨率的要求，提出了基于卷积神经网络的阵列测向方法DCNN-DOA
3.  探究了模型失配条件下的阵列测向问题，提出了基于Deep-unfolding型深度神经网络的阵列测向方法LISTA（Learned Lterative Soft Thresholding Algorithm）
4.  探索了能自动利用未标记样本提升性能的半监督学习在阵列测向中的应用，提出了基于流形正则化的半监督测向方法MR-SSDOA（Manifold Regularization based Semi-Supervised DOA），以及基于深度网络预训练的半监督测向方法Pretrained-DCNN

# 引言:

## 研究现状

### 模型驱动方法

方法特点

1.  先建立信号方向与阵列观测数据间的数学模型，然后根据不同匹配准则实现模型与数据之间的最佳匹配从而估计信号方向
2.  当预设模型与实际数据吻合时，这些方法可以逼近克拉美罗下界，达到近似最优性能
3.  当预设模型与真实数据不吻合或偏差较大时，模型驱动方法测向性能急速恶化甚至完全失效
4.  根据各种模型失配的情况可以研究相应的补偿或校正算法，但系统模型误差复杂多样，要对 他们一一实现校正难度非常大

发展过程

1.  1950s，CBF（Conventional Beam Forming），将传统用于时间序列分析的傅里叶变换方法扩展到空间谱估计中。但其不能分辨处于同一个波束宽度内的多个不同目标
2.  1960s，“将时域高分辨频谱估计方法推广到 空域谱估计算法中去，以改善常规波束形成法的测向精度与分辨率” （高分辨谱估计法）。其空间分辨率得到提高，但是估计精度有限，并且需要假设信号源在空间是连续分布的，信号是空间平稳的随机过程
3.  子空间方法
    1.  进程
        1.  1979，Schmidt 提出了多重信号分类（MUltiple SIgnal Classiification，MUSIC）方法，显著增强了空间谱估计的超分辨能力，大大提高了空间谱估计的精度
        2.  1985，Roy 和 Kailath 提出了旋转不变子空间参数估计法（Estimationi of Signal Parameters Via Rotational Invariance Techniques， ESPRIT），利用子空间之间的旋转不变性来估计信号角度。
    2.  缺点
        1.  子空间分解类算法的性能极大地依赖于阵列输出协方差矩阵的准确估计以及信号子空间/噪声子空间的准确分解
        2.  在信噪比低、快拍数少、信源相干、模型失配等 情况下，协方差矩阵的估计精度会明显下降
        3.  子空间分解依 赖的矩阵分解通常需要较大运算量
4.  1980s，子空间拟合类算法，利用阵列流形矩阵和阵列接收数据子空间之间的拟合关系来估计未知角度参数
    1.  进程：
        1.  1988，最大似然（Maximum likelihood， ML）估计法
        2.  1991，加权子空间拟合（Weighted subspace fitting，WSF）算法
    2.  优点：子空间拟合类算法在低信噪比、少快拍数据以及信号相干等条件下的测向性能相对稳定
    3.  缺点：这类方法可以归结为高维非线性优化问题，求解过程需要在全局进行多维联合搜索，其运算量比子空间分解类算法更是高几个数量级
5.  稀疏重构方法，利用入射信号空域稀 疏性以及稀疏重构理论实现阵列测向的方法
    1.  贪婪追踪类
        1.  进程
            1.  基追踪（Basis Pursuit，BP）
            2.  匹配追踪（Matching Pursuit，MP）
            3.  正交匹配追踪（Orthogonal Matching Pursuit，OMP）
            4.  基于回溯的正交匹配追踪（BAcktracking OMP，BAOMP）
            5.  正则化正交匹配追踪（Regularized OMP， ROMP）
            6.  压缩采样匹配追踪（ Compressive Sampling Matching Pursuit，CoSaMP）
        2.  特点
            1.  对观测模型的稀疏度要求较高
            2.  如果不同信号分量之间的相关性较强，贪婪追踪类方法的重构性能会显著下降
            3.  空间分辨能力方面存在明显局限
    2.  $L_p$范数类
        1.  进程
            1.  p=0：JLZA-DOA（Joint $L_{2,0}$ Approximation DOA）
            2.  0<p<1：FOCUSS（FOCal Underdetermined System Solver）
            3.  p=1：$L_1-SVD$（$L_{1}$-Singular Value Decomposition）、$L_1-SRACV$（$L_1$-Sparse Representation of Array Covariance Vectors）
        2.  特点
            1.  重构性能显著优于 贪婪追踪类算法
            2.  当 p 较小时，相应的优化问题属于非凸优化问题，目标函数可能存在许多局部极小值，难以保证全局收敛，算法存在收敛至局部极值的风险
            3.  当 p=1时，目标函数的全局极值解与真实信号方向可能不一致，导致测向结果可能是有偏的
            4.  算法实现过程中引入了正则化因子等参数需要人为主观确定，算法稳健性不佳
    3.  稀疏贝叶斯学习类（SBL）
        1.  特点
            1.  借助贝叶斯多级概率模型消除不同信号分量之间的相互影响，能更好地适应低信 噪比、少快拍、以及空域临近信号等信号环境
            2.  目标函数高度非 线性，只能依赖于迭代优化算法求解
            3.  计算量大，不利于实时求解
            4.  假设信号和噪声都服从高斯分布， 这与实际情况也有较大出入


### 数据驱动方法

方法特点

1.  在计算复杂度、估计精度以及非理想信号与应用环境适应性等方面具备优势
2.  将阵列测向问题与机器学习中的分类或拟合问题简单地对等起来，没有充分挖掘阵列测向模型中蕴含的先验信息（信号先验信息，阵列结构先验信息等）以及角度估计问题作为一个参数估计问题的特殊性
3.  如何在只有少量标记训练样本的条件下，提高阵列测向系统的角度估计性能也是一个亟待解决的问题

发展过程

1.  1980s，用机器学习技术实现阵列测向的主要思想是利用神经网络优越的计算性能降低阵列测向方法所需的计算量
    1.  进程
        1.  利用神经网络实现矩阵的快速分解（特征值分解，酉分解），得到信号子空间和噪声子空间以后仍然利用 MUSIC 等子空间类方法的测向原理实现角度估计
        2.  把到达角估计问题作为一个优化问题映射到神经网络上，利用神经网络优化、模拟退火等技术求得目标函数的极值点，以实现 DOA 估计
    2.  特点
        1.  避免了特征分解、峰值搜索等复杂计算，在计算效率上有突出的优势
        2.  基本原理仍然延续了子空间方法等模型驱动类测向方法的原理，所以其 测向性能仍受到模型驱动类方法固有性能局限的制约
2.  基于有监督学习机器学习的DOA估计方法
    1.  原理：通过人工神经网络（Artificial Neural Network，ANN）模拟阵列接收数据与信号入射角之间的非线性映射关系，并利用训练数据对人工神经网络的网络参数进行训练，训练完成后则可对未知角度阵列接收数据进行 DOA 估计
    2.  优点
        1.  神经网络产生的角度估计值与期望的角度值非常接近，角度估计性能与传统模型驱动类算法相当
        2.  通过添加噪声，能够产生不同信噪比环境下的训练数据和测试数据以保证神经网络的泛化性能
        3.  与 MUSIC 等模型驱动类算法相比，神经网络类测向方法对阵列误差的适应性更好
        4.  神经网络可以用纳秒数量级的并行电路实现，所以它的收敛速度很快
    3.  缺点
        1.  是一种难以解释的“黑箱”模型， 因而无法产生明确的概念表示和知识，理论性质不够清楚
        2.  神经网络的结构设置涉及大量的参数，而参数的确定缺乏理论指导，主要靠研究者的经验以及不断尝试（trial and error）进行调整
        3.  ANN 中多个非线性层的叠加导致其代价函数是高度非凸的，网络训练容易收敛到局部极值点，出现过拟合现象
3.  2000s，基于支持向量机（SVM）的阵列测向方法
    1.  利用支持向量回归（Support Vector Regression，SVR）实现角度函数拟合的方法
    2.  利用 SVM 实现角度分类的方法
    3.  利用有限的样本信息，在模型复杂度（即对特定学习样本的训练精度）以及学习能力（即无错误地识别任意样本的能力）之间寻求最佳折中，以期获得最好的泛化推广能力
    4.  SVM 是一个二次寻优问题，可以得到全局最优解，解决了 ANN 中无法避免的局部极值问题
4.  2004年，用高斯核 SVR 实现近场和远场信号的 DOA 估计
    1.  李鹏飞和张旻将各天线阵元接收信号之间的相位差作为 SVR 输入，利用 SVR 构建相位差特征与来波方位角之间的函数映射关系，提升了方法在低信噪比条件下的 DOA 估计性能
    2.  C. Ashok 及何项等人研究了基于 SVR 的 DOA 估计方法对非高斯噪声环境的适应性
    3.  Mahdi 等人研究了阵元互耦条件下基于 SVR 的 DOA 估计方法
    4.  利用混合核函数 SVR 进行 DOA 估计
    5.  用 LS-SVM（Least Squares Support Vector Machine）把原始 SVM 中带约束的二次优化问题转化为不带约束的凸优化问题，从而提升 SVM 对大规模数据的适应能力
    6.  将 DOA 估计问题转化为多分类问题，利用多个 SVM （二分类学习器）构造多分类器从而实现 DOA 估计
5.  基于深度学习的 DOA 估计算法
    1.  进程
        1.  2014 年，上海大学的 Yan Chen 等人利用无监督卷积深信网络（Convolutional Deep Belief Network，CDBN）提取角度特征，然后将这些提取的特征输入 SVR 中进行角度估计
        2.  Takeda 等人采用深度神经网络（Deep Neural Network，DNN）对声音信号的 DOA 进行估计
        3.  2017 年，Chakrabarty 和 Habets 首次将卷积神经网络（Convolution Neural Network，CNN）引入到 DOA 估计问题的研究中
    2.  特点
        1.  在提高估计准确率的同时具备对麦克风位置扰动的鲁棒性
        2.  大多利用了声音信号的时域特性，需要积累较长时间的观测数据才能实现测向
        3.  采用分类思想实现测向，分类间隔一般为 5°甚至 10°，导致测向精度较低
        4.  声音信号测向只针对单信号测向场景，或同时不同频信号测向场景，这与电磁信号测向系统面临的实际情况也不吻合
6.  利用深度学习实现电磁信号的高精度测向
    1.  刘章孟提出能适应多种阵列误差的深度学习测向框架，该框架采用 Autoencoder （AE）+ DNN 结构，先利用 AE 对接收信号进行空域滤波，将不同区域的信号粗略分开， 然后利用多个 DNN 对每一较窄区域内的信号实现高精度测向
    2.  Hongji Huang 针对 MIMO 系统提出了基于 DNN 的超分辨 DOA 估计和信道估计方法
    3.  Houhong Xiang 利用 AE 学习不同方位来波信号的特征，从而解决甚高频雷达中的测向问题

# 模型推导：

## 阵列测向数学模型

阵列测向技术是指利用在空间分布的传感器阵列估计辐射源信号角度参数的技术

典型的阵列测向系统由三部分组成：

1.  空间信号入射——目标空间
2.  传感器阵列接收——观测空间
3.  处理器参数估计——估计空间

### 窄带信号观测模型

假设$K$个相互独立的远场信号 $\vec s(t)=[s_1(t),...,s_K(t)]^T$ 同时入射到M个增益为 $1$ 的各向同性阵元所组成的阵列上，阵元之间无互耦和通道不一致的干扰，则 t 时刻第m个阵元的输出为：

$$x_m(t)=\sum_{k=1}^Ks_k(t-\tau_{m,k})+v_m(t),\quad m=1,...,M$$

其中，$\tau_{m,k}$ 表示第 $k$ 个信号到达参考阵元与到达第 m 个阵元之间的时间差； $v_m(t)$ 表示第 $m$ 个阵元上的观测噪声（通常假设为均值为零的高斯白噪声，且不同阵元不同时刻的观测噪声之间相互独立）

假设信号源为窄带信号源，则第 $k$ 个入射信号 $s_k(t)$ 可用如下复包络的形式表示：

$$\begin{cases}s_k(t)=u_k(t)e^{j(\omega t+\phi_k(t))} \\s_k(t-\tau)=u_k(t-\tau)e^{j(\omega (t-\tau)+\phi_k(t-\tau))} \end{cases} \quad k=1, ..., K$$

其中，$u_k(t)$ 和 $\phi_k(t)$ 分别表示第 $k$ 个信号的幅值和相位，$\omega$ 为信号中心频率；对于远场信号，当 $\tau$ 很小时，信号包络和相位在 $\tau$ 时间内的变化可以忽略：

$$\begin{cases}u_k(t-\tau)\approx u_k(t)\\\phi_k(t-\tau)\approx\phi_k(t)\end{cases}$$

联立以上三个公式为：

$$x_m=\sum_{k=1}^Ku_k(t)e^{j(\omega t+\phi_k(t))}+v_m(t)\\=\sum_{k=1}^Ks_k(t)e^{-j\omega \tau_{m,k}}+v_m(t)\quad \\m=1,...,M$$

则阵列输出向量 $\vec{x}(t)=[x_1(t),x_2(t),...,x_M(t)]^T$ 可表示为：

$$\vec{x}(t)=\sum_{k=1}^K\vec{a}_ks_k(t)+\vec{v}(t)=\vec{A}\vec{s}(t)+\vec{v}(t)$$

其中 $\vec{A}=[\vec{a}_1,...,\vec{a}_K]$ 是 K 个入射信号对应的阵列响应矩阵，$\vec{a}_k=[e^{-j\omega \tau_{1,k}},...,e^{-j\omega \tau_{M,k}}]^T$是角度 $\theta_k$ 对应的阵列响应矢量

若阵列接收器共采集了 $N$ 组快拍数据，即 $t=t_1,...,t_N$ ，则阵列的输出矩阵 $\vec{X}=[\vec{x}(t_1),...\vec{x}(t_N)]$ 可表示为：$\vec{X}=\vec{A}\vec{S}+\vec{V}$

其中 $\vec{A}$ 为阵列响应矩阵，$\vec{S }$ 为信号波形矩阵，$\vec{V}$ 为观测噪声矩阵

响应矩阵 $\vec{A}$ 由阵元间的信号接收延时 $\tau$ 决定：

假设各信号之间以及信号与噪声之间相互独立，则阵列输出的协方差矩阵为：

$$\vec{R}=E[\vec{x}(t)x^H(t)]\\=\vec{A}E[\vec{s}(t)\vec{s}^H(t)]\vec{A}^H+E[\vec{v}(t)\vec{v}^H(t)]\\=\vec{A}\vec{R}_s\vec{A}^H+\vec{R}_v$$

其中，$R_s=diag[\eta_1,..,\eta_K]$ 和 $\vec{R}_v=\sigma^2\vec{I}_M$ 分别表示信号的协方差矩阵和噪声协方差矩阵。$\eta_k$ 为第 $k$ 个信号的功率，$\sigma^2$ 为噪声的功率

阵列测向过程就是从观测数据 $\vec{X}$ 或协方差矩阵 $\vec{R}$ 估计参数 $\theta$ 的过程：

$$\vec{R}\ or\ \vec{X}\Rightarrow \begin{bmatrix}\theta_1\\\theta_2\\.\\.\\.\\\theta_K\end{bmatrix}$$

### 宽带信号观测模型

阵元输出与窄带信号相同：$$x_m(t)=\sum_{k=1}^Ks_k(t-\tau_{m,k})+v_m(t),\quad m=1,...,M$$

协方差矩阵应表示为：

$$(\vec{R}){i,j}=E[x_i(t)x^H(t)]\\=E[\sum{k=1}^Ks_k(t-\tau_{i,k})s^*k(t-\tau)]+E[v_i(t)v_j(t)]\\=\sum{k=1}^Kr_k(\tau_{i.k}-\tau_{j,k})+\sigma^2\delta(i-j)\\i,j=1,...,M$$

其中 $\delta(v)$ 为示性函数，仅在 $v=0$ 时取非零值1。$r_k(\tau)=E[s_k(t)s_k^*(t+\tau)]$ 为第 k 个信号的时延相关函数，例如 BPSK 信号的时延相关函数为：

$$r(\tau)=\begin{cases}e^{-j\omega\tau}\cfrac{T-|\tau|}{T},\quad|\tau|<T\\0,\quad otherwise\end{cases}$$

可以看出，宽带信号的协方差矩阵不仅与入射角度有关，还与信号的时延相关函数有关。

# 机器学习类阵列测向方法处理框架

## 数据预处理（特征提取）

目的：通过对原始数据 $\vec{X}$ 进行适当变换，在尽可能保留信号角度信息的基础上，减少输入的维度，从而降低训练的复杂度、加快学习收敛速度、减少训练时间。

1.  时差预处理
    1.  利用信号到达时间差作为模型输入：$\vec{r}=[\tau_2,...,\tau_M]^T\in\mathbb{R}^{(M-1)\times1}$
    2.  受噪声、干扰影响较大，难以实现高精度估计
    3.  时差估计结果通常是信号采样间隔 $T_s$ 的整数倍，存在量化误差问题
2.  相位差预处理
    1.  在窄带信号假设下，时差可等效为相位差：$\vec{r}=[\Delta\phi_2,...,\Delta\phi_M]^T\in\mathbb{R}^{(M-1)\times1},\quad \Delta\phi_m=\omega\tau_m$
    2.  估计精度受观测噪声、信号调制样式等因素影响较大
    3.  只能处理单个窄带入射信号
3.  广义互相关(GCC)矩阵预处理
    1.  GCC矩阵：$\rho_{i,j}(\tau)=\cfrac{1}{\Omega}\sum_{\omega=0}^{\Omega}\vec{\Psi}(\omega)X_i(\omega)X_j^*(\omega)e^{j\omega\tau} ,\quad i,j=1,...,M;\tau\in[-\tau_{max},\tau{min}]$
        1.  $X_i(\omega)$ 是第 $i$ 个阵元信号 $x_i(t)$ 的傅立叶变换
        2.  $\omega$ 为信号角频率，其最大值为 $\Omega$
        3.  $\Psi(\omega)=H_i(\omega)H_j^*(\omega)$ 是频率加权矩阵，用来抑制噪声和多径影响。当 $H(\omega)=\cfrac{1}{|X{\omega}|}$ 时是常用的 PHAT（PHAse Transform）加权
        4.  $\tau_{max}$ 是信号到达第一个阵元与最后一个阵元的最大时间差，其应该是采样时间间隔的整数倍。对于均匀线阵 $\tau_{max}=[\cfrac{(M-1)\times d}{cT_S}]T_s$
    2.  GCC矩阵本质上是基于时差的特征，其与信号调制样式、频率带宽都无关
    3.  GCC矩阵不直接估计时间差，引入误差更少，使得特征更加文件
    4.  GCC矩阵的维度为 $M\times M\times P,\quad P=\cfrac{2\tau_{max}}{T_s}$，维度过大（甚至超过原始阵列数据）
    5.  角度分辨率与时差特征一样受到信号采样频率的影响，精度不高
4.  协方差矩阵预处理
    1.  阵列协方差矩阵 $\vec{R}\in\mathbb{C}^{M\times M}$，消除了阵列原始数据中信号波形的干扰，同时保留了入射角度的全部信息，其维度也降低了（假设快拍数 $N$ 大于阵元数 $M$）
    2.  考虑到协方差矩阵是共轭对称矩阵以及其对角线元素与信号入射角无关，一般只需用 $\vec{R}$ 的上三角或下三角部分（不含对角线元素）作为输入：$\overline{r}=[\overline{r}{12},...\overline{r}{1M},\overline{r}{23},...,\overline{r}{2M},...,\overline{r}{(M-1)M}]^T,\quad \overline{r}{pq}=R_{p,q}$
    3.  由于 $\overline{r}$ 为复数矢量，实际输入一般为：$\vec{r}=\cfrac{[\mathfrak{R}(\overline{r}^T),\mathfrak{I}(\overline{r}^T)]^T}{||\overline{r}||_2}$
    4.  用上式作为输入，维度由 $2M^2$ 降为 $M(M-1)$
    5.  协方差矩阵作为输入特征性能稳健
    6.  但是输入-输出空间曲面映射关系不够清晰、维度仍然较高、与信号频率/带宽等参数相关
5.  协方差矩阵特征向量预处理
    1.  对阵列协方差矩阵 $\vec{R}$ 进行特征值分解：$\vec{R}=\vec{U}\vec{\Sigma}\vec{U}^H=\vec{U}_s\vec{\Sigma}_s\vec{U}^H_s+\vec{U}_v\vec{\Sigma}_v\vec{U}^H_v$
        1.  $\vec{U}_s,\vec{U}_v$ 分别表示信号子空间与噪声子空间
    2.  信号子空间包含所有入射角信息，可以作为角度估计输入特征
    3.  特征向量需要进行特征值分解，计算量大，时效性差
    4.  在少快拍低信噪比条件下，特征分解结果不理想，得到的信号子空间准确度显著下降

## 机器学习模型

1.  函数拟合模型（回归）
    1.  精度高，结果连续
    2.  形式复杂，需要大量样本
    3.  在处理多信号角度估计时，需要预先估计信号的个数，建立多个函数映射关系
    4.  RBFNN（Radial Basis Function Neural Network，径向基函数神经网络）、MLP（Multilayer Perceptron，多层感知机）、SVR（Support Vector Regression，支持向量回归）
2.  分类模型
    1.  角度估计是离散的。受到空域划分间隔影响，无法达到无偏估计
    2.  当多个信号同时入射，常规分类问题无法解决
3.  模式编码模型
    1.  是分类模型的变形结构，但是不直接输出类别，而是输出“空间谱”
    2.  能够处理多信号同时入射
    3.  可以通过插值方法改善精度


## 机器学习优化方法

1.  SVR优化方法：
    1.  目标函数：$L(w,b)=C\sum_{i=l}^Ll_\epsilon(x^i,y^i)+\cfrac{1}{2}||w||^2$
    2.  \epsilon 的不敏感损失函数：$l_\epsilon(x^i,y^i)=\begin{cases}0,\quad if\ |y^i-f(x^i)|\leq \epsilon\\|y^i-f(x^i)|- \epsilon,\quad otherwise\end{cases}$
2.  神经网络优化方法：反向传播，梯度下降

## 数据后处理

1.  函数拟合模型
    1.  一般直接输出角度，不需要进行后处理
    2.  在全向估计时，为了保证 $360^\circ\rightarrow0^\circ$ 的连续性，将网络的输出值变为入射角度的正、余弦值，此时 $\hat{\theta}=arctg[\cfrac{sin(\theta)}{cos(\theta)}]$
2.  模式编码模型
    1.  采用插值方法增加精度：$\hat{\theta}k=\cfrac{\sqrt{\alpha_{k,1}}}{\sqrt{\alpha_{k,1}}+\sqrt{\alpha_{k,2}}}\ \hat{\theta}{k,1}+\cfrac{\sqrt{\alpha_{k,2}}}{\sqrt{\alpha_{k,1}}+\sqrt{\alpha_{k,2}}}\ \hat{\theta}_{k,2}\quad, k=1,2,...,K$
        1.  $\hat{\theta}_{k,1}, \ \hat{\theta}_{k,2}$ 分别表示 $\alpha$ 中第 $k$ 个谱峰的左侧和右侧对应的方向值
        2.  $\alpha_{k,1},\ \alpha_{k,2} 为 \hat{\theta}_{k,1},\ \hat{\theta}_{k,2}$ 对应的幅度值，开根号是取其信号的功率而非幅度

